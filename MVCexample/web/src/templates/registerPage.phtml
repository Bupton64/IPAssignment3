




<?php include "header.phtml" ?>
<!---------- Body starts --------------->
<script type = "text/javascript">
    function validateForm()
    {
        var password = document.forms["registration"]["password"].value;
        var password_confirm = document.forms["registration"]["password_confirm"].value;

        var submitButton = document.getElementById('submit-handle');


        if(password !== password_confirm){
            alert("Passwords do not match!");
            return false;
        }

        get(function(){
            myVar = this.responseText;
            if(myVar === 'true'){

               submitButton.click();
            } else{
                alert("Username already exists");
            }
        })
        return false;
    }

    function get(callback) {
        xmlhttp = new XMLHttpRequest();
        var username = document.forms["registration"]["username"].value;
        xmlhttp.open("GET", "registrationValidation.php?q=" + username, true);
        xmlhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                // defensive check
                if (typeof callback === "function") {
                    // apply() sets the meaning of "this" in the callback
                    callback.apply(xmlhttp);
                }
            }
        };
        xmlhttp.send();
    }

</script>


<div id="wrapper">
	<!---------- Header Wrapper starts --------------->
	<div id="headerWrapper">
		<div id= "header" class="container">
			<div id= "logo">
				<h1><a href="<?= $linkTo('home'); ?>">ToolStocker<a></h1>
				</div>
			
		</div>
		
	</div>
      
	<!---------- Header Wrapper End here --------------->

	<!--- Content Start -->
	<div id= "page">
		
		<div id = "content">
			<div class = "title">
			<h2>Registration Form</h2>
			</div>
		   <div id="registration">
        <form method="POST" name="registration" action="<?= $linkTo('accountCreated'); ?>" >
            <p>Name: <input type="text" placeholder="Name" name="name" size="40" pattern="^[a-zA-Z0-9\s]+$" title="Alphanumeric characters and spaces only"> </p>
            <p>Username: <input type="text" placeholder="Username"  name="username" size="40" required pattern="^[a-zA-Z0-9]+$" title="Alphanumeric characters only" ></p>
            <p>Email: <input type="text" placeholder="Email" name="email" size="40" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" title="Please enter a valid email address e.g: example@gmail.com" ></p>
            <p>Password: <input type="password" placeholder="Password" name="password" size="40" required pattern="^(?=.*[A-Z])([a-zA-Z0-9]{7,15})$" title="Must contain at least one uppercase letter, and be between 7-15 characters" > </p>
            <p>Confirm Password: <input type="password" placeholder="Password" name="password_confirm" size="40" required pattern="^(?=.*[A-Z])([a-zA-Z0-9]{7,15})$" title="Must contain at least one uppercase letter, and be between 7-15 characters" ></p>
            </div>
            <p type="hidden" id="validate"></p>
            <button id="submit-registration" value="Register" onclick="return validateForm()">Register</button> 
            <input id="submit-handle" type="submit" style="display: none">
        </form>
		    <br> 	
			
		</div>
	</div>
	<!--- Content Ends here ----------->
</div>







<!---------- Body ends -------------------->
<?php include "footer.phtml" ?>
